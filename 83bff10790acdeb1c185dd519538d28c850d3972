{
  "comments": [
    {
      "key": {
        "uuid": "60db1517_52d1a814",
        "filename": "libs/binder/Android.bp",
        "patchSetId": 2
      },
      "lineNbr": 80,
      "author": {
        "id": 1120458
      },
      "writtenOn": "2020-01-16T17:23:55Z",
      "side": 1,
      "message": "This isn\u0027t a use of libbinder though. Since it is a static dependency, all the shared dependencies are dropped. This seems like it is just a convenient way to only include the symbols from libstagefright_foundation which are needed for the APEX (and dropping all of the ones that actually depend on libbinder).\n\nDo we want to consider this case for apex_available? The important thing is that the libbinder symbols or library itself aren\u0027t in the APEX. I agree we should check this for correctness (we should even be checking headers, although they are such a mess in general), but in the meantime, this means com.android.media could start actually including libbinder in the APEX.\n\nWDYT?",
      "range": {
        "startLine": 80,
        "startChar": 0,
        "endLine": 80,
        "endChar": 80
      },
      "revId": "83bff10790acdeb1c185dd519538d28c850d3972",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ec726c90_770ecefe",
        "filename": "libs/binder/Android.bp",
        "patchSetId": 2
      },
      "lineNbr": 80,
      "author": {
        "id": 1132673
      },
      "writtenOn": "2020-01-16T17:32:43Z",
      "side": 1,
      "message": "Well, this is strange. This kind of dependency is already skipped. See https://r.android.com/1209284\nI currently am not sure why the build fails without this line :( Perhaps there might be a \u0027real\u0027 dependency to libbinder via other path.",
      "parentUuid": "60db1517_52d1a814",
      "range": {
        "startLine": 80,
        "startChar": 0,
        "endLine": 80,
        "endChar": 80
      },
      "revId": "83bff10790acdeb1c185dd519538d28c850d3972",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5754d1ae_032acbe5",
        "filename": "libs/binder/Android.bp",
        "patchSetId": 2
      },
      "lineNbr": 80,
      "author": {
        "id": 1120458
      },
      "writtenOn": "2020-01-16T17:42:29Z",
      "side": 1,
      "message": "Well, looking at a built com.android.media APEX, there is no \u0027/dev/vndbinder\u0027 or \u0027/dev/binder\u0027 string or \u0027Binder\u0027 strings (some \u0027Binder\u0027 strings from HIDL libs, but not from libbinder), so if libbinder was statically included, ProcessState/Binder could not be used, and therefore almost nothing could be used.\n\nCould it be coming from libbinder_ndk being used as a shared_lib?",
      "parentUuid": "ec726c90_770ecefe",
      "range": {
        "startLine": 80,
        "startChar": 0,
        "endLine": 80,
        "endChar": 80
      },
      "revId": "83bff10790acdeb1c185dd519538d28c850d3972",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8e1ae050_68c5040e",
        "filename": "libs/binder/Android.bp",
        "patchSetId": 2
      },
      "lineNbr": 80,
      "author": {
        "id": 1132673
      },
      "writtenOn": "2020-01-16T17:49:32Z",
      "side": 1,
      "message": "No. libbinder_ndk and its dependencies are not visited here.",
      "parentUuid": "5754d1ae_032acbe5",
      "range": {
        "startLine": 80,
        "startChar": 0,
        "endLine": 80,
        "endChar": 80
      },
      "revId": "83bff10790acdeb1c185dd519538d28c850d3972",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "fe849684_59a650ea",
        "filename": "libs/binder/Android.bp",
        "patchSetId": 2
      },
      "lineNbr": 80,
      "author": {
        "id": 1120458
      },
      "writtenOn": "2020-01-16T18:25:15Z",
      "side": 1,
      "message": "I thought maybe this could be a master/AOSP difference, since I understand the dependencies here are only cleaned up on master, but I can\u0027t find any evidence of libbinder being used in the AOSP APEX here either.\n\nIs there a way to print a tree of all the dependencies visited? Perhaps that would be a helpful tool for Soong development.",
      "parentUuid": "8e1ae050_68c5040e",
      "range": {
        "startLine": 80,
        "startChar": 0,
        "endLine": 80,
        "endChar": 80
      },
      "revId": "83bff10790acdeb1c185dd519538d28c850d3972",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "acbe06aa_122c3db0",
        "filename": "libs/binder/Android.bp",
        "patchSetId": 2
      },
      "lineNbr": 80,
      "author": {
        "id": 1132673
      },
      "writtenOn": "2020-01-16T18:37:45Z",
      "side": 1,
      "message": "prebuilts/build-tools/linux-x86/bin/ninja -f out/soong/build.ninja -t path pathA pathB\n\nshows the dependency chai from pathA to pathB. Strangely, the following doesn\u0027t show anything.\n\nprebuilts/build-tools/linux-x86/bin/ninja -f out/soong/build.ninja -t path out/soong/.intermediates/frameworks/av/apex/com.android.media/android_common_cfi_com.android.media_image/com.android.media.apex.unsigned frameworks/native/libs/binder/Binder.cpp\n\nI will investigate more.",
      "parentUuid": "fe849684_59a650ea",
      "range": {
        "startLine": 80,
        "startChar": 0,
        "endLine": 80,
        "endChar": 80
      },
      "revId": "83bff10790acdeb1c185dd519538d28c850d3972",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b44b7ced_eb87ba40",
        "filename": "libs/binder/Android.bp",
        "patchSetId": 2
      },
      "lineNbr": 80,
      "author": {
        "id": 1132673
      },
      "writtenOn": "2020-01-30T09:46:53Z",
      "side": 1,
      "message": "Update. The dependency to libbinder exists because libstagefright_foundation re-exports headers from libbinder. And also because libbinder exports not only its own  headers in the source tree, but also the generated headers from AIDL compiler (e.g. IServiceManager.h).",
      "parentUuid": "acbe06aa_122c3db0",
      "range": {
        "startLine": 80,
        "startChar": 0,
        "endLine": 80,
        "endChar": 80
      },
      "revId": "83bff10790acdeb1c185dd519538d28c850d3972",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    }
  ]
}